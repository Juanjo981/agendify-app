<!-- Header superior fijo -->
<ion-header class="dashboard-header">
  <ion-toolbar class="toolbar-custom">
    <div class="toolbar-content">


      <!-- Logo a la izquierda -->
      <div class="logo-full">
        <img src="assets/img/logo-barra.png" alt="Agendify logo" />
      </div>

      <!-- Contenedor derecho -->
      <div class="toolbar-right">
        <div class="notification-wrapper" (click)="toggleNotificaciones()">
          <div class="notif-icon-container">
            <ion-icon name="notifications-outline"></ion-icon>

            <div *ngIf="totalNotificaciones() > 0" class="notification-badge">
              {{ totalNotificaciones() }}
            </div>
          </div>
        </div>


        <div class="user-menu" (click)="toggleMenu()">
          <span class="username">{{ nombreUsuario }}</span>
          <ion-icon name="chevron-down-outline"></ion-icon>
        </div>
      </div>
    </div>
  </ion-toolbar>

  <!-- Menú desplegable de usuario estilo premium -->
  <div *ngIf="menuAbierto" class="user-dropdown" role="menu">

    <!-- HEADER DEL PERFIL -->
    <div class="user-header">
      <div class="avatar-wrapper">
        <img src="assets/img/default-avatar.jpg" alt="avatar" class="avatar" />
      </div>

      <div class="user-info">
        <h3>{{ nombreUsuario }}</h3>
        <p>Profesional de la salud</p>
      </div>

      <button class="logout-btn" (click)="confirmarSalir()">Salir</button>
    </div>

  
    <!-- SECCIÓN: ACTIVIDAD -->
    <div class="section">
      <label class="section-title">ACTIVIDAD</label>

      <div class="section-item" (click)="irAMiPerfil()">
        <ion-icon name="time-outline"></ion-icon>
        <span>Mi Actividad</span>
      </div>

      <div class="section-item" (click)="irAMiPerfil()">
        <ion-icon name="chatbubble-ellipses-outline"></ion-icon>
        <span>Mensajes</span>
      </div>
    </div>


    <!-- SECCIÓN: MI CUENTA -->
    <div class="section">
      <label class="section-title">MI CUENTA</label>

      <div class="card-grid">

        <div class="mini-card" (click)="irAMiPerfil()">
          <ion-icon name="business-outline"></ion-icon>
          <p>Consultorio</p>
        </div>

        <div class="mini-card" (click)="irAConfiguracion()">
          <ion-icon name="settings-outline"></ion-icon>
          <p>Configuración</p>
        </div>

      </div>
    </div>

    <!-- BOTÓN FINAL -->
    <div class="footer-btn">
      <button (click)="irAMiPerfil()">Ir a mi perfil</button>
    </div>

  </div>


  <!-- NOTIFICACIONES ESTILO PANEL MODERNO -->
  <div *ngIf="notificacionesAbiertas" class="notification-panel">

    <div class="notif-header">
      <h2>Notificaciones</h2>
      <p>Tienes {{ activeList.length }} sin leer</p>
    </div>

    <!-- Tabs -->
    <div class="notif-tabs">
      <div class="tab" [class.active]="activeTab === 'messages'" (click)="changeTab('messages')">
        Mensajes
      </div>

      <div class="tab" [class.active]="activeTab === 'events'" (click)="changeTab('events')">
        Eventos
      </div>

      <div class="tab" [class.active]="activeTab === 'status'" (click)="changeTab('status')">
        Estado
      </div>
    </div>

    <!-- Contenedor general -->
    <div class="notif-list">
      <div class="timeline-line"></div>

      <div *ngFor="let item of activeList" class="notif-row">
        <div class="dot"></div>

        <div class="notif-content">
          <p class="notif-text">{{ item.text }}</p>
          <span class="notif-time">{{ item.fecha }}</span>
        </div>

        <button class="notif-read-btn">
          ✓
        </button>
      </div>

    </div>

    <div class="notif-footer">
      <button (click)="verTodasNotificaciones()">Todas las notificaciones</button>
    </div>

  </div>



</ion-header>

<!-- Layout general: menú lateral + contenido -->
<div class="dashboard-layout">

  <!-- Menú lateral con ancho dinámico -->
  <aside class="sidebar" [style.width.px]="sidebarWidth">
    <ion-list>

      <ion-item button routerLink="/dashboard/agenda" routerLinkActive="activo"
        [routerLinkActiveOptions]="{ exact: true }" [class.contraido]="sidebarContraido" lines="none">
        <ion-icon slot="start" name="calendar-outline"></ion-icon>
        <ion-label>Agenda</ion-label>
      </ion-item>

      <ion-item button routerLink="/dashboard/pacientes" routerLinkActive="activo"
        [routerLinkActiveOptions]="{ exact: true }" [class.contraido]="sidebarContraido" lines="none">
        <ion-icon slot="start" name="people-outline"></ion-icon>
        <ion-label>Pacientes</ion-label>
      </ion-item>

      <ion-item button routerLink="/dashboard/sesiones" routerLinkActive="activo"
        [routerLinkActiveOptions]="{ exact: true }" [class.contraido]="sidebarContraido" lines="none">
        <ion-icon slot="start" name="cash-outline"></ion-icon>
        <ion-label>Sesiones</ion-label>
      </ion-item>

      <ion-item button routerLink="/dashboard/estadisticas" routerLinkActive="activo"
        [routerLinkActiveOptions]="{ exact: true }" [class.contraido]="sidebarContraido" lines="none">
        <ion-icon slot="start" name="bar-chart-outline"></ion-icon>
        <ion-label>Estadísticas</ion-label>
      </ion-item>

      <ion-item button routerLink="/dashboard/configuracion" routerLinkActive="activo"
        [routerLinkActiveOptions]="{ exact: true }" [class.contraido]="sidebarContraido" lines="none">
        <ion-icon slot="start" name="settings-outline"></ion-icon>
        <ion-label>Configuración</ion-label>
      </ion-item>
    </ion-list>
    <!-- Botón hamburguesa para contraer/expandir sidebar -->
    <div class="sidebar-toggle" (click)="toggleSidebar()" title="Contraer menú">
      <ion-icon [name]="sidebarContraido ? 'chevron-forward-outline' : 'chevron-back-outline'"></ion-icon>
    </div>

  </aside>

  <!-- Divider para redimensionar -->
  <div class="resizer" (mousedown)="startResizing($event)"></div>

  <!-- Contenido principal -->
  <main class="main-content">
    <ion-content>
      <ion-router-outlet class="dashboard-content"></ion-router-outlet>
    </ion-content>
  </main>

</div>
<!-- Menú inferior solo visible en móviles -->
<div class="bottom-menu" [class.abierto]="menuInferiorAbierto">

  <!-- Botón central para expandir -->
  <div class="bottom-toggle" (click)="toggleMenuInferior()">
    <ion-icon [name]="menuInferiorAbierto ? 'chevron-down-outline' : 'chevron-up-outline'"></ion-icon>
  </div>

  <!-- Contenido del menú expandido -->
  <div class="bottom-content">
    <ion-item button routerLink="/dashboard/agenda" lines="none">
      <ion-icon name="calendar-outline" slot="start"></ion-icon>
      <ion-label>Agenda</ion-label>
    </ion-item>
    <ion-item button routerLink="/dashboard/pacientes" lines="none">
      <ion-icon name="people-outline" slot="start"></ion-icon>
      <ion-label>Pacientes</ion-label>
    </ion-item>
    <ion-item button routerLink="/dashboard/sesiones" lines="none">
      <ion-icon slot="start" name="cash-outline"></ion-icon>
      <ion-label>Sesiones</ion-label>
    </ion-item>
    <ion-item button routerLink="/dashboard/estadisticas" lines="none">
      <ion-icon name="bar-chart-outline" slot="start"></ion-icon>
      <ion-label>Estadísticas</ion-label>
    </ion-item>
    <ion-item button routerLink="/dashboard/configuracion" lines="none">
      <ion-icon name="settings-outline" slot="start"></ion-icon>
      <ion-label>Configuración</ion-label>
    </ion-item>
  </div>

</div>